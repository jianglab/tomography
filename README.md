# tomography
software for alignment and 3-D reconstruction of electron tomography tilt series

# tomoThickness.py
This file is an instruction of *tomoThickness.py* which is used to simultaneously determine the sample thickness, sample tilt and mean free path.

Example: python tomoThickness.py --tiltseries virus009.ali --tiltangles virus009.tlt --x0 1600,1500,1600,300 --y0 1600,1700,1800,300 --boxsize 200 --B 240 --d0 100 --alpha0 0 --theta0 0 --niter 400 --plotData --plotResults --modifyTiltFile

* --tiltseries: the file name of the aligned tilt series with tilt axis along Y-axis. Usually, this is the aligned tilt series (*.ali) generated by IMOD software after fine alignment.

* --tiltangles: the file name of the tilt angle file. Usually, this is the tilt angles file (*.tlt) generated by IMOD software after fine alignment without tilt angle offset correction. If the tilt angle offset is corrected during fine alignment, the determined sample tilt in our script will not reflect the initial orientation of the specimen in 3D space.

* --x0 and --y0: these two arguments need to be used and explained together. Our script requires users to provide the coordinates of patch center in order to locate and track it throughout the entire tilt series. --x0 and --y0 are the X- and Y- coordination of the patch center, respectively. For example, you want to select 2 patches, the first patch center is (xa, ya), the second patch center is (xb, yb), you should specify like --x0 xa, xb --y0 ya, yb

* --boxsize or --adaptiveBox: the size of the patch which is clipped and tracked along the tilt series. For example, one patch center is selected as (xa, ya), the script will clip a region with X ranging from (xa-boxsize/2) to (xa+boxsize/2), Y ranging from (ya-boxsize/2) to (ya+boxsize/2) on the untilted image, and track it along the entire tilt series. Our script works for both constant and adaptive (tilt angle dependent) boxsizes along the tilt series.

* --d0 --alpha0 --theta0 --B --MFP: initials of sample thickness, sample tilt along X axis and Y axis, B factor, and mean free path. For vitreous ice, mean free path is 350nm@300kV and 300nm@200kV, when energy filter is on.

* --niter: the number of iterations in the basinhopping method (optimization method) we use to fit the results.

* --plotData: plot of the original data before the step of optimization, including curvilinear mode and linear mode

* --plotResults: plot of the original data before the step of optimization, including curvilinear mode; and plot of the same tilt series after correction of the sample tilt.

* --modifyTiltFile: you can use this argument to correct the tilt angles and write out to a new tilt angle file (such as newTiltAngle.tlt).

In the output, theta0 and alpha0 are the initial angles of sample tilt around Y-axis and X-axis, respectively. And gamma0 is the 3D angle between the normal vector of the sample plane and the Z-axis.
